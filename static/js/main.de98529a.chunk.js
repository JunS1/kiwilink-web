(this.webpackJsonpkiwilink=this.webpackJsonpkiwilink||[]).push([[0],{116:function(e,t,a){e.exports=a.p+"static/media/logo.4f684e93.svg"},139:function(e,t,a){e.exports=a(243)},143:function(e,t,a){},144:function(e,t,a){},145:function(e,t,a){},157:function(e,t,a){},194:function(e,t,a){},234:function(e,t,a){},235:function(e,t,a){e.exports=a.p+"static/media/kiwi.e6d17f98.png"},236:function(e,t,a){},243:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),r=a(19),o=a.n(r),i=(a(143),a(12)),c=a(13),u=a(17),l=a(16),m=(a(144),a(251)),d=a(137),f=Object(d.a)(),p=(a(145),a(73));p.initializeApp({apiKey:"AIzaSyAgtOMsgueqoE1acwvIDADQLZDPWYiW7PE",authDomain:"stinder-3b3b6.firebaseapp.com",databaseURL:"https://stinder-3b3b6.firebaseio.com",projectId:"stinder-3b3b6",storageBucket:"stinder-3b3b6.appspot.com",messagingSenderId:"274076431598",appId:"1:274076431598:web:7a3a0b1887c288eb9cefff"});var h=p,v=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).login=function(){h.auth().signInWithEmailAndPassword(s.state.email,s.state.password).then((function(e){s.props.history.push("/dashboard"),window.location.reload()})).catch((function(e){return s.setState({error:e.message})}))},s.state={email:"",password:"",error:""},s}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"SignInContainer"},n.a.createElement("p",null,"Welcome to KiwiLink"),this.state.error.length>0&&n.a.createElement("p",null,this.state.error),n.a.createElement("form",{className:"SignInInput",onSubmit:this.handleSubmit},n.a.createElement("label",null,n.a.createElement("input",{type:"email",placeholder:"Email",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})),n.a.createElement("label",null,n.a.createElement("input",{placeholder:"Password",type:"password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}}))),n.a.createElement("div",{className:"SignInButtonContainer"},n.a.createElement("button",{onClick:this.login,className:"SignInButton"},"Log in"),n.a.createElement("button",{className:"SignInButton",onClick:function(){e.props.history.push("/register"),window.location.reload()}},"Sign up")))}}]),a}(n.a.Component),g="https://firebasestorage.googleapis.com/v0/b/stinder-3b3b6.appspot.com/o/photos%2Fdefault.png?alt=media&token=df58e5e6-dbce-49fb-9c5d-75028e46138d",b=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={email:"",password:"",first_name:"",last_name:"",error:""},e.register=function(){h.auth().createUserWithEmailAndPassword(e.state.email,e.state.password).then((function(t){h.database().ref("users/").child(t.user.uid).set({email:e.state.email,first_name:e.state.first_name,last_name:e.state.last_name,bio:"",image:g}).then((function(){e.props.history.push("/dashboard"),window.location.reload()})).catch((function(e){return console.log(e)}))})).catch((function(t){return e.setState({error:t.message})}))},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"SignInContainer"},n.a.createElement("p",null,"Register now"),this.state.error.length>0&&n.a.createElement("p",null,this.state.error),n.a.createElement("form",{className:"SignInInput",onSubmit:this.handleSubmit},n.a.createElement("label",null,n.a.createElement("input",{placeholder:"First name",type:"text",value:this.state.first_name,onChange:function(t){return e.setState({first_name:t.target.value})}})),n.a.createElement("label",null,n.a.createElement("input",{placeholder:"Last name",type:"text",value:this.state.last_name,onChange:function(t){return e.setState({last_name:t.target.value})}})),n.a.createElement("label",null,n.a.createElement("input",{placeholder:"Email",type:"email",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}})),n.a.createElement("label",null,n.a.createElement("input",{placeholder:"Password",type:"password",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}}))),n.a.createElement("div",{className:"SignInButtonContainer"},n.a.createElement("button",{lassName:"SignInButton",onClick:this.register},"Sign up"),n.a.createElement("button",{onClick:function(){e.props.history.push("/"),window.location.reload()},className:"SignInButton"},"Log in")))}}]),a}(n.a.Component),E=a(4),N=a.n(E),C=a(9),y=(a(157),a(116)),j=a.n(y),w=a(51),_=a.n(w),k=(a(91),a(92),a(93),a(58)),S=a.n(k),x=(a(194),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).saveBio=function(){s.setState({bio:s.state.newBio}),h.database().ref("users/".concat(s.props.user.uid)).update({bio:s.state.newBio}),s.props.saveBio(s.state.newBio),s.setState({editBio:!1})},s.saveCourses=function(){s.setState({courses:s.state.newCourses}),h.database().ref("users/".concat(s.props.user.uid)).update({courses:s.state.newCourses}),s.props.saveCourses(s.state.newCourses),s.setState({editCourses:!1})},s.saveMajors=function(){s.setState({majors:s.state.newMajors}),h.database().ref("users/".concat(s.props.user.uid)).update({majors:s.state.newMajors}),s.props.saveMajors(s.state.newMajors),s.setState({editMajors:!1})},s.filter=function(e){var t=e;return S()({options:t,labelKey:"name",valueKey:"id"})},s.state={bio:"",newBio:"",courses:[],newCourses:[],majors:[],newMajors:[],editBio:!1,editCourses:!1,editMajors:!1},s}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.setState({bio:this.props.user.bio,newBio:this.props.user.bio,courses:this.props.user.courses,newCourses:this.props.user.courses,majors:this.props.user.majors,newMajors:this.props.user.majors})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"ProfileContainer"},n.a.createElement("div",null,n.a.createElement("img",{className:"ProfilePicture",src:this.props.user.image,alt:"loading"})),n.a.createElement("div",{className:"Welcome"},"Welcome, ",this.props.user.first_name," ",this.props.user.last_name),this.state.editBio?n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("textarea",{className:"Bio-Area",value:this.state.newBio,onChange:function(t){return e.setState({newBio:t.target.value})}})),n.a.createElement("button",{className:"Edit-Bio",onClick:this.saveBio},"save"),n.a.createElement("button",{className:"Edit-Bio",onClick:function(){return e.setState({editBio:!1,newBio:e.state.bio})}},"cancel")):n.a.createElement("div",null,n.a.createElement("div",{className:"Bio"},this.state.bio),n.a.createElement("button",{className:"Edit-Bio",onClick:function(){return e.setState({editBio:!0})}},0===this.state.bio.length?"click to add a bio":"click to edit bio")),n.a.createElement("div",{className:"Line"}),this.state.editCourses?n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement(_.a,{labelKey:"name",valueKey:"id",options:this.props.courses,value:this.state.newCourses,multi:!0,filterOptions:this.filter(this.props.courses),className:"Dropdown",onChange:function(t){t=t.map((function(e){return{name:e.name.split(":")[0],id:e.id}})),e.setState({newCourses:t})},placeholder:"Search for courses..."})),n.a.createElement("button",{className:"Edit-Button",onClick:this.saveCourses},"save"),n.a.createElement("button",{className:"Edit-Button",onClick:function(){return e.setState({editCourses:!1,newCourses:e.state.courses})}},"cancel")):n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("button",{className:"Edit-Button",onClick:function(){return e.setState({editCourses:!0})}},this.state.courses&&0===this.state.courses.length?"Click here to add classes":"Classes (click here to edit)")),n.a.createElement("div",{className:"ItemList"},this.props.user.courses&&this.props.user.courses.map((function(e){return n.a.createElement("button",{className:"Item",key:e.id},e.name)})))),this.state.editMajors?n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement(_.a,{labelKey:"name",valueKey:"id",options:this.props.majors,value:this.state.newMajors,multi:!0,filterOptions:this.filter(this.props.majors),className:"Dropdown",onChange:function(t){return e.setState({newMajors:t})},placeholder:"Search for majors..."})),n.a.createElement("button",{className:"Edit-Button",onClick:this.saveMajors},"save"),n.a.createElement("button",{className:"Edit-Button",onClick:function(){return e.setState({editMajors:!1,newMajors:e.state.majors})}},"cancel")):n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("button",{className:"Edit-Button",onClick:function(){return e.setState({editMajors:!0})}},this.state.majors&&0===this.state.majors.length?"Click here to add majors":"Major(s) (click here to edit)")),n.a.createElement("div",{className:"ItemList"},this.props.user.majors&&this.props.user.majors.map((function(e){return n.a.createElement("button",{className:"Item",key:e.id},e.name)})))))}}]),a}(n.a.Component)),O=(a(98),a(28)),B=a(136),R=new(function(){function e(){var t=this;Object(i.a)(this,e),this.send=function(e,a){e.forEach((function(e){var s={text:e.text,timestamp:h.database.ServerValue.TIMESTAMP,user:e.user,sent:!0};t.getRoom(a).child("/texts/").push(s)}))},this.parse=function(){var e=Object(C.a)(N.a.mark((function e(t){var a,s,n,r,o,i,c,u;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.val(),s=a.user,n=a.text,r=a.timestamp,o=a.sent,i=a.system,c=t.key,u=new Date(r),e.abrupt("return",{_id:c,createdAt:u,text:n,sent:o,user:s,system:i});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.get=function(){var e=Object(C.a)(N.a.mark((function e(a,s){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getRoom(s).child("/texts").on("child_added",function(){var e=Object(C.a)(N.a.mark((function e(s){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,t.parse(s);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.getReadReceipts=function(e,a){t.getRoom(e).child("/members/".concat(t.uid)).child("last_seen").on("value",function(){var e=Object(C.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},this.unsubscribeReadReceipts=function(e){t.getRoom(e).child("/members/".concat(t.uid)).child("last_seen").off()},this.getGroupChatListener=function(e,a){h.database().ref("users/".concat(t.uid,"/messages")).on("child_added",function(){var t=Object(C.a)(N.a.mark((function t(a){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(a));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),h.database().ref("users/".concat(t.uid,"/messages")).on("child_removed",function(){var e=Object(C.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},this.unsubscribeGroupChatListener=function(){h.database().ref("users/".concat(t.uid,"/messages")).off()},this.getNonRelatedUsers=function(){var e=Object(C.a)(N.a.mark((function e(a,s,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!=s&&null!=s&&null!=s.length&&0==s.length?(a=a.filter((function(e){return e!==t.uid}))).map((function(e){return n.add(e)})):a.map((function(e){if(e!=t.uid){var a=!1;s.map((function(t){t===e&&(a=!0)})),!1===a&&n.add(e)}}));case 1:case"end":return e.stop()}}),e)})));return function(t,a,s){return e.apply(this,arguments)}}(),this.getMatches=function(){var e=Object(C.a)(N.a.mark((function e(a,s){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.database().ref("/users").once("value").then((function(e){var n=e.val()||{},r=n[t.uid].friends||{},o=n[t.uid].requestedFriends||{},i=n[t.uid].requestingFriends||{},c=Object.assign(r,o,i),u=new Set;for(var l in n[t.uid].majors)u.add(n[t.uid].majors[l].name);var m=new Set;for(var d in n[t.uid].courses)m.add(n[t.uid].courses[d].name);var f=new Set;t.getNonRelatedUsers(Object.keys(n),Object.keys(c),f);var p,h=Object(B.a)(f);try{for(h.s();!(p=h.n()).done;){var v=p.value,g=!1,b=[],E="";if(s){for(var N in n[v].courses)m.has(n[v].courses[N].name)&&(g=!0),b.push(n[v].courses[N].name);for(var C in n[v].majors)u.has(n[v].majors[C].name)&&(g=!0),E=(E=E.concat(n[v].majors[C].name)).concat("\n"),n[v].all_majors=E}else{for(var y in g=!0,n[v].courses)b.push(n[v].courses[y].name);for(var j in n[v].majors)E=(E=E.concat(n[v].majors[j].name)).concat("\n"),n[v].all_majors=E}g&&a.push({uid:v,first_name:n[v].first_name,last_name:n[v].last_name,bio:n[v].bio,major:n[v].all_majors,classes:b,image:n[v].image})}}catch(w){h.e(w)}finally{h.f()}})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.getFriendListener=function(e){h.database().ref("users/".concat(t.uid,"/friends")).on("child_added",function(){var t=Object(C.a)(N.a.mark((function t(a){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(a));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},this.unsubscribeFriendListener=function(){h.database().ref("users/".concat(t.uid,"/friends")).off()},this.getRequestListener=function(e,a){h.database().ref("users/".concat(t.uid,"/requestingFriends")).on("child_added",function(){var t=Object(C.a)(N.a.mark((function t(a){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(a));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),h.database().ref("users/".concat(t.uid,"/requestingFriends")).on("child_removed",function(){var e=Object(C.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},this.unsubscribedRequestListener=function(){h.database().ref("users/".concat(t.uid,"/requestingFriends")).off()},this.getAllReqUsers=function(){var e=Object(C.a)(N.a.mark((function e(a){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.database().ref("users/").once("value").then((function(e){var s=e.val();for(var n in s[t.uid].requestingFriends){var r="";for(var o in s[n].majors)r=(r=r.concat(s[n].majors[o].name)).concat(" ");s[n].allMajors=r;var i=[];for(var c in s[n].courses)i.push(s[n].courses[c].name);a.push({uid:n,first_name:s[n].first_name,last_name:s[n].last_name,bio:s[n].bio,major:s[n].allMajors,classes:i,image:s[n].image})}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getReqUsers=function(){var e=Object(C.a)(N.a.mark((function e(a){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.database().ref("users/").once("value").then((function(e){var s=e.val();for(var n in s[t.uid].requestingFriends){var r="";for(var o in s[n].majors)r=(r=r.concat(s[n].majors[o].name)).concat(" ");s[n].allMajors=r;var i=[];for(var c in s[n].courses)i.push(s[n].courses[c].name);a.push({uid:n,first_name:s[n].first_name,last_name:s[n].last_name,bio:s[n].bio,major:s[n].allMajors,classes:i,image:s[n].image})}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}return Object(c.a)(e,[{key:"getRoom",value:function(e){return h.database().ref("messages/".concat(e))}},{key:"picture",value:function(){var e=Object(C.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.database().ref("users/".concat(t,"/image")).once("value");case 2:return e.abrupt("return",e.sent.val());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"off",value:function(e){this.getRoom(e).child("/texts").off()}},{key:"firstName",value:function(e){var t=e.search(" ");return-1==t?e:e.substring(0,t)}},{key:"requestFriend",value:function(e){h.database().ref("/users/".concat(this.uid,"/requestedFriends/")).update(Object(O.a)({},e,e)),h.database().ref("users/".concat(e,"/requestingFriends/")).update(Object(O.a)({},this.uid,this.uid))}},{key:"displayRecent",value:function(e,t,a,s){if(e&&t){if("System"===a.name)return e;var n=(a._id===this.uid?"You":this.firstName(a.name))+": ";(e=e.replace(/\n/g," ")).length<30?n+=e:n+=e.substring(0,30)+"...";var r=new Date(t),o=((new Date).getTime()-r.getTime())/864e5;if(o<1){var i=r.getHours(),c=r.getMinutes(),u=i>=12?"pm":"am";n+=" \xb7 "+(i=0!==(i%=12)?i:12)+":"+(c=c<10?"0"+c:c)+" "+u}else if(o<7){n+=" \xb7 "+r.toString().split(" ")[0]}else{var l=r.toString().split(" ");n+=" \xb7 "+(l[1]+0+l[2])}return n}}},{key:"removeRequest",value:function(e){h.database().ref("users/".concat(this.uid,"/requestingFriends/").concat(e)).remove().then((function(){})).catch((function(e){console.log(e)})),h.database().ref("users/".concat(e,"/requestedFriends/").concat(this.uid)).remove().then((function(){})).catch((function(e){console.log(e)}))}},{key:"confirmRequest",value:function(e,t,a){var s=this;h.database().ref("/messages").push({texts:[{_id:1,text:"Say hi to your new friend!",timestamp:h.database.ServerValue.TIMESTAMP,user:{_id:1,name:"System"},system:!0}],group_name:""}).then((function(n){var r;h.database().ref("/messages/".concat(n.key,"/members/")).update((r={},Object(O.a)(r,e,{first_name:t,last_name:a,last_seen:null}),Object(O.a)(r,s.uid,{first_name:"".concat(s.first_name),last_name:"".concat(s.last_name),last_seen:null}),r)),h.database().ref("users/".concat(s.uid,"/friends/")).update(Object(O.a)({},e,{first_name:t,last_name:a,room:n.key})).then((function(){})).catch((function(e){console.log(e)})),h.database().ref("users/".concat(e,"/friends/")).update(Object(O.a)({},s.uid,{first_name:"".concat(s.first_name),last_name:"".concat(s.last_name),room:n.key})).then((function(){})).catch((function(e){console.log(e)}))})),h.database().ref("users/".concat(this.uid,"/requestingFriends/").concat(e)).remove().then((function(){})).catch((function(e){console.log(e)})),h.database().ref("users/".concat(e,"/requestedFriends/").concat(this.uid)).remove().then((function(){})).catch((function(e){console.log(e)}))}},{key:"uid",get:function(){return(h.auth().currentUser||{}).uid}},{key:"first_name",get:function(){return(h.auth().currentUser||{}).displayName.split("@")[0]}},{key:"last_name",get:function(){return(h.auth().currentUser||{}).displayName.split("@")[1]}}]),e}()),q=function(e){Object(u.a)(s,e);var t=Object(l.a)(s);function s(e){var r;return Object(i.a)(this,s),(r=t.call(this,e)).renderClasses=function(e){var t=[];if(e.length>3){for(var a=0;a<2;a++)t.push(e[a]);t.push("and more...")}else t=e;return 0==t.length&&t.push("no classes"),t.map((function(e){return n.a.createElement("div",{className:"RoundBox"},n.a.createElement("p",{className:"ClassesArray"},e))}))},r.requestFriend=function(e){var t=r.state.users[e];null!==t.id?R.requestFriend(t.uid):console.warn("request user id is null");var a=r.state.users;a.splice(e,1),r.setState({users:a})},r.renderMatches=function(){return console.log(r.state.users),r.state.users.map((function(e,t){return console.log(e.first_name),n.a.createElement("div",{className:"ForYouCard"},n.a.createElement("div",{className:"ForYouImgContainer"},n.a.createElement("img",{className:"ForYouCardImg",src:e.image}),n.a.createElement("button",{className:"ForYouImgBotBar",onClick:function(){return r.requestFriend(t)}},n.a.createElement("div",null,n.a.createElement("img",{className:"ForYouRequestButton",src:a(67)})))),n.a.createElement("div",{className:"ForYouUserInfoContainer"},n.a.createElement("br",null),n.a.createElement("div",{className:"FullName"},n.a.createElement("p",null,e.first_name+" "+e.last_name)),n.a.createElement("p",null,e.bio),n.a.createElement("p",{className:"ClassTitle"},"classes this quarter:"),r.renderClasses(e.classes)))}))},r.state={users:[]},r}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=Object(C.a)(N.a.mark((function e(){var t,a=this;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.users,e.next=3,R.getMatches(t,!0);case 3:this.setState({users:t},(function(){console.log("matched users: "+a.state.users)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.a.createElement("div",{className:"ForYouContainer"},n.a.createElement("div",{className:"ForYouHeader"},n.a.createElement("div",{className:"ForYouTitle"},"For You Page"),n.a.createElement("p",null,"Scroll through this page (from left to right) to see optimized friend recommendations. Befriend similar people with relevant classes and majors")),n.a.createElement("section",{className:"ForYouCardsContainer"},n.a.createElement("div",{className:"ForYouPlaceHolder"}),this.renderMatches()))}}]),s}(n.a.Component),F=function(e){Object(u.a)(s,e);var t=Object(l.a)(s);function s(e){var r;return Object(i.a)(this,s),(r=t.call(this,e)).renderClasses=function(e){var t=[];if(e.length>3){for(var a=0;a<2;a++)t.push(e[a]);t.push("and more...")}else t=e;return 0==t.length&&t.push("no classes"),t.map((function(e){return n.a.createElement("div",{className:"RoundBox"},n.a.createElement("p",{className:"ClassesArray"},e))}))},r.requestFriend=function(e){var t=r.state.users[e];null!==t.id?R.requestFriend(t.uid):console.warn("request user id is null");var a=r.state.users;a.splice(e,1),r.setState({users:a})},r.renderMatches=function(){return console.log(r.state.users),r.state.users.map((function(e,t){return console.log(e.first_name),n.a.createElement("div",{className:"ForYouCard"},n.a.createElement("div",{className:"ForYouImgContainer"},n.a.createElement("img",{className:"ForYouCardImg",src:e.image}),n.a.createElement("button",{className:"ForYouImgBotBar",onClick:function(){return r.requestFriend(t)}},n.a.createElement("div",null,n.a.createElement("img",{className:"ForYouRequestButton",src:a(67)})))),n.a.createElement("div",{className:"ForYouUserInfoContainer"},n.a.createElement("div",{className:"FullName"},n.a.createElement("p",null,e.first_name+" "+e.last_name)),n.a.createElement("p",null,e.bio),n.a.createElement("p",{className:"ClassTitle"},"classes this quarter:"),r.renderClasses(e.classes)))}))},r.state={users:[]},r}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=Object(C.a)(N.a.mark((function e(){var t,a=this;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.users,e.next=3,R.getMatches(t,!1);case 3:this.setState({users:t},(function(){console.log("matched users: "+a.state.users)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.a.createElement("div",{className:"ForYouContainer"},n.a.createElement("div",{className:"ForYouHeader"},n.a.createElement("div",{className:"ForYouTitle"},"Explore Page"),n.a.createElement("p",null,"Scroll through this page (from left to right) to see randomized friend recommendations. Befriend random UW students!")),n.a.createElement("section",{className:"ForYouCardsContainer"},n.a.createElement("div",{className:"ForYouPlaceHolder"}),this.renderMatches()))}}]),s}(n.a.Component),M=a(74),I=(a(231),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={friends:[],selectedUsers:[],group_chat_name:""},e.filter=function(e){var t=e;return S()({options:t,labelKey:"name",valueKey:"id"})},e.confirmGroup=function(){var t=e.state.group_chat_name;h.database().ref("/messages").push({group_name:t,texts:[{text:e.props.user.first_name+" has created a new group",timestamp:h.database.ServerValue.TIMESTAMP,system:!0,user:{_id:1,id:1,name:"System"}}]}).then((function(t){for(var a=0;a<e.state.selectedUsers.length;a++){var s=e.state.selectedUsers[a].id,n=e.state.selectedUsers[a].name;h.database().ref("/users/".concat(s,"/messages")).update(Object(O.a)({},t.key,t.key)),h.database().ref("/messages/".concat(t.key,"/members/").concat(s)).update({name:n,active:!0})}h.database().ref("/users/".concat(e.props.user.uid,"/messages")).update(Object(O.a)({},t.key,t.key)),h.database().ref("/messages/".concat(t.key,"/members/").concat(e.props.user.uid)).update({name:e.props.user.first_name+" "+e.props.user.last_name,active:!0}),e.props.cancel()}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;h.database().ref("users/".concat(this.props.user.uid,"/friends")).once("value").then((function(t){var a=t.val(),s=[];for(var n in a){var r={id:n,name:a[n].first_name+" "+a[n].last_name};s.push(r)}e.setState({friends:s},(function(){console.log(e.state.friends)}))}))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{onSubmit:this.handleSubmit},n.a.createElement("label",null,n.a.createElement("input",{type:"text",className:"GroupName-Create",placeholder:"Group name",value:this.state.group_chat_name,onChange:function(t){e.setState({group_chat_name:t.target.value})}})),n.a.createElement("label",null,n.a.createElement(_.a,{labelKey:"name",valueKey:"id",options:this.state.friends,value:this.state.selectedUsers,multi:!0,filterOptions:this.filter(this.state.friends),className:"Dropdown",onChange:function(t){return e.setState({selectedUsers:t})},placeholder:"Search for your friends"})),n.a.createElement("div",{className:"Space-Between"},n.a.createElement("button",{className:"Create-Button",onClick:function(){return e.confirmGroup()}},"Confirm"),n.a.createElement("button",{className:"Create-Button",onClick:this.props.cancel},"Cancel"))))}}]),a}(n.a.Component)),Y=(a(234),function(e){Object(u.a)(s,e);var t=Object(l.a)(s);function s(e){var r;return Object(i.a)(this,s),(r=t.call(this,e)).getRooms=function(){R.getGroupChatListener((function(e){var t=e.val();h.database().ref("messages/".concat(t)).once("value").then((function(e){var s=r.state.rooms;s.push(t);var n=r.state.room_details,o=e.val();o.id=t,o.url=a(235),o.recent={},o.messages=n[t]&&n[t].messages||[],n[t]=o,r.setState({rooms:s,room_details:n},(function(){r.getListeners(t)}))}))}),(function(e){var t=e.val();R.off(t),R.unsubscribeReadReceipts(t);var a=r.state.room_details;delete a[t];var s=r.state.rooms,n=s.indexOf(t);n>-1&&s.splice(n,1),r.setState({rooms:s,room_details:a})})),R.getFriendListener((function(e){var t=e.key;h.database().ref("users/".concat(t)).once("value").then((function(e){var a=e.val(),s="",n=[],o=r.state.user_details;for(var i in a.majors)s+=a.majors[i].name+"\n";for(var c in a.courses)n.push(a.courses[c].name);a.courses=n,a.majors=s,o["".concat(t)]=a,r.setState({user_details:o})})).catch((function(e){console.log(e)}));var a=e.val(),s=r.state.rooms,n=a.room;s.push(n),h.database().ref("messages/".concat(n)).once("value").then(function(){var e=Object(C.a)(N.a.mark((function e(o){var i,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.state.room_details,(c=o.val()).id=n,e.next=5,R.picture(t);case 5:c.url=e.sent,c.group_name=a.first_name+" "+a.last_name,c.recent={},c.messages=i[n]&&i[n].messages||[],c.uid=t,i[n]=c,r.setState({rooms:s,room_details:i},(function(){r.getListeners(n)}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),(function(e){e.key;var t=e.val().room;R.off(t),R.unsubscribeReadReceipts(t);var a=r.state.room_details;delete a[t];var s=r.state.rooms,n=s.indexOf(t);n>-1&&s.splice(n,1),r.setState({rooms:s,room_details:a})}))},r.getListeners=function(e){R.get((function(t){var a=r.state.room_details;a[e]&&((!a[e].recent.createdAt||a[e].recent.createdAt<t.createdAt)&&(a[e].recent=t),a[e].messages=M.GiftedChat.append(a[e].messages,t).sort((function(e,t){return t.createdAt-e.createdAt})),r.setState({room_details:a}))}),e),R.getReadReceipts(e,(function(t){var a=r.state.room_details;a[e]&&(a[e].members[r.props.user.uid].last_seen=t.val(),r.setState({room_details:a}))}))},r.unsubscribeListeners=function(){for(var e=0;e<r.state.rooms.length;e++)R.off(r.state.rooms[e]),R.unsubscribeReadReceipts(r.state.rooms[e])},r.compare=function(e,t){return e.recent.createdAt<t.recent.createdAt?1:e.recent.createdAt>t.recent.createdAt?-1:0},r.cancelCreateGroup=function(){r.setState({create:!1})},r.renderClasses=function(e){var t=[];if(e.length>3){for(var a=0;a<2;a++)t.push(e[a]);t.push("and more...")}else t=e;return t.map((function(e){return n.a.createElement("div",{className:"RoundBox"},n.a.createElement("p",{className:"ClassesArray"},e))}))},r.state={email:"",displayName:"",rooms:[],room_details:{},user_details:{},refreshing:!1,url:null,most_recent:"",isLoading:!0,focused:!1,currentRoom:null,create:!1},r}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=h.auth().currentUser,a=t.email,s=t.displayName;this.setState({email:a,displayName:s}),h.database().ref("users/".concat(R.uid,"/image")).once("value").then((function(t){var a=t.val();e.setState({url:a})})),this.getRooms()}},{key:"componentWillUnmount",value:function(){this.unsubscribeListeners()}},{key:"renderChat",value:function(){var e=this.state,t=e.currentRoom;return e.create?n.a.createElement(I,{user:this.props.user,cancel:this.cancelCreateGroup}):t?n.a.createElement(M.GiftedChat,{showUserAvatar:!0,user:{_id:this.props.user.uid,id:this.props.user.uid,name:this.props.user.first_name+" "+this.props.user.last_name,avatar:this.props.user.image},messages:this.state.room_details["".concat(t)].messages,onSend:function(e){return R.send(e,t)}}):void 0}},{key:"renderChatRooms",value:function(){var e=this;return n.a.createElement("div",{style:A.convoList},n.a.createElement("div",{className:"Align"},n.a.createElement("img",{src:this.props.user.image,className:"You"}),n.a.createElement("div",{className:"Message-Header"},"Convos")),n.a.createElement("button",{className:"Create",onClick:function(){return e.setState({create:!0})}},"Create new group +"),Object.values(this.state.room_details).sort((function(t,a){return e.compare(t,a)})).map((function(t){return n.a.createElement("button",{className:"Convos",type:"button",onClick:function(){e.state.currentRoom&&h.database().ref("messages/".concat(e.state.currentRoom,"/members/").concat(e.props.user.uid)).update({last_seen:h.database.ServerValue.TIMESTAMP}),e.setState({currentRoom:t.id,create:!1})}},n.a.createElement("img",{src:t.url,className:"Avatar"}),n.a.createElement("div",null,n.a.createElement("div",{className:"GroupName"},t.group_name),n.a.createElement("div",{className:e.state.currentRoom===t.id?"read":t.members[e.props.user.uid].last_seen<t.recent.createdAt?"Unread":"read"},t.recent.user?R.displayRecent(t.recent.text,t.recent.createdAt,t.recent.user,e.props.user.uid):null)))})))}},{key:"renderSetting",value:function(){if(this.state.currentRoom&&this.state.room_details["".concat(this.state.currentRoom)].uid){var e=this.state.room_details["".concat(this.state.currentRoom)].uid,t=this.state.user_details[e];return console.log("obj:",t),n.a.createElement("div",{className:"ForYouCard"},n.a.createElement("div",{className:"ForYouImgContainer"},n.a.createElement("img",{className:"ForYouCardImg",src:t.image})),n.a.createElement("div",{className:"ForYouUserInfoContainer"},n.a.createElement("p",null,t.first_name," ",t.first_name),n.a.createElement("p",null,t.bio),n.a.createElement("p",null,"classes this quarter:"),this.renderClasses(t.courses)))}}},{key:"render",value:function(){return n.a.createElement("div",{style:A.container},n.a.createElement("div",{style:A.channelList},this.renderChatRooms()),n.a.createElement("div",{style:A.chat},this.renderChat()),n.a.createElement("div",{style:A.settings},this.renderSetting()))}}]),s}(n.a.Component)),A={container:{flex:1,display:"flex",flexDirection:"row",height:"100vh"},channelList:{display:"flex",flex:1,flexDirection:"column"},chat:{display:"flex",flex:3,flexDirection:"column",borderWidth:"1px",borderColor:"#ccc",borderRightStyle:"solid",borderLeftStyle:"solid"},settings:{display:"flex",flex:2,flexDirection:"column"},convoList:{flex:1,display:"flex",flexDirection:"column"}},L=(a(236),function(e){Object(u.a)(s,e);var t=Object(l.a)(s);function s(e){var r;return Object(i.a)(this,s),(r=t.call(this,e)).removeRequest=function(e){r.state.users[e].uid&&R.removeRequest(r.state.reqUsers[e].uid);var t=r.state.users;t.splice(e,1),r.setState({reqUsers:t})},r.confirmRequest=function(e){var t=r.state.users[e];t.uid?R.confirmRequest(t.uid,t.first_name,t.last_name):console.warn("confirm user id is null");var a=r.state.users;a.splice(e,1),r.setState({reqUsers:a})},r.renderClasses=function(e){var t=[];if(e.length>2){for(var a=0;a<1;a++)t.push(e[a]);t.push("and more...")}else t=e;return t.map((function(e){return n.a.createElement("div",{className:"RoundBox"},n.a.createElement("p",{className:"ClassesArray"},e))}))},r.renderRequests=function(){return console.log(r.state.users),r.state.users.map((function(e,t){return console.log(e.first_name),n.a.createElement("div",{className:"RequestContainer"},n.a.createElement("div",{className:"RequestCard"},n.a.createElement("div",{className:"RequestImgContainer"},n.a.createElement("img",{className:"RequestCardImg",src:e.image}),n.a.createElement("button",{className:"ForYouImgBotBar",onClick:function(){return r.requestFriend(t)}},n.a.createElement("div",null,n.a.createElement("img",{className:"ForYouRequestButton",src:a(67)})))),n.a.createElement("div",{className:"ForYouUserInfoContainer"},n.a.createElement("div",{className:"FullName"},n.a.createElement("p",null,e.first_name+" "+e.last_name)),n.a.createElement("p",null,e.bio),n.a.createElement("p",{className:"ClassTitle"},"classes this quarter:"),r.renderClasses(e.classes))),n.a.createElement("div",{className:"RequestButtonContainer"},n.a.createElement("button",{className:"AcceptButton",onClick:function(){r.confirmRequest(t)}},"Accept"),n.a.createElement("button",{className:"DeclineButton",onClick:function(){r.removeRequest(t)}},"Decline")))}))},r.state={users:[]},r}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=Object(C.a)(N.a.mark((function e(){var t,a=this;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.users,e.next=3,R.getAllReqUsers(t);case 3:this.setState({reqUsers:t}),R.getRequestListener(function(){var e=Object(C.a)(N.a.mark((function e(t){var s,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.val(),n=a.state.users,n.some((function(e){return e.uid==s}))){e.next=7;break}return e.next=6,R.getReqUser(n,s);case 6:a.setState({users:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.a.createElement("div",{className:"ForYouContainer"},n.a.createElement("div",{className:"ForYouHeader"},n.a.createElement("div",{className:"ForYouTitle"},"Friend Requests"),n.a.createElement("p",null,"Scroll through this page to accept or decline friend requests from different users.")),n.a.createElement("section",{className:"ForYouCardsContainer"},this.renderRequests()))}}]),s}(n.a.Component)),T=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={user:{},isLoading:!0,profile:!0,for_you:!1,explore:!1,message:!1,request:!1,courses:[],majors:[]},e.goToProfile=function(){e.setState({profile:!0,for_you:!1,explore:!1,request:!1,message:!1})},e.goToForYou=function(){e.setState({profile:!1,for_you:!0,explore:!1,request:!1,message:!1})},e.goToExplore=function(){e.setState({profile:!1,for_you:!1,explore:!0,request:!1,message:!1})},e.goToFriendRequest=function(){e.setState({profile:!1,for_you:!1,explore:!1,request:!0,message:!1})},e.goToMessage=function(){e.setState({profile:!1,for_you:!1,explore:!1,request:!1,message:!0})},e.saveBio=function(t){var a=e.state.user;a.bio=t,e.setState({user:a})},e.saveCourses=function(t){var a=e.state.user;a.courses=t,e.setState({user:a})},e.saveMajors=function(t){var a=e.state.user;a.majors=t,e.setState({user:a})},e.logOut=function(){h.auth().signOut(),e.props.history.push("/"),window.location.reload()},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;h.auth().onAuthStateChanged(function(){var t=Object(C.a)(N.a.mark((function t(a){var s;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=a.uid,console.log(s),h.database().ref("users/".concat(s)).once("value").then((function(t){var a=t.val();a.uid=s,e.setState({user:a})})),h.database().ref("majors/").once("value").then((function(t){var a=t.val();e.setState({majors:a})})),h.database().ref("courses/").once("value").then((function(t){var a=t.val();e.setState({courses:a,isLoading:!1})}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"render",value:function(){return this.state.isLoading?null:n.a.createElement("div",{className:"Container"},n.a.createElement("header",{className:"Header"}),n.a.createElement("div",{className:"Body"},n.a.createElement("nav",{className:"MainNavBar"},n.a.createElement("span",{className:"Top-left"},n.a.createElement("img",{src:j.a,className:"App-logo",alt:"logo"}),n.a.createElement("div",{className:"Title"},"KiwiLink")),n.a.createElement("ul",{className:"MainNavButton"},n.a.createElement("button",{className:this.state.profile?"Selected":"Nav-Button",onClick:this.goToProfile},n.a.createElement("div",{className:"Nav-Text"},"Profile"))),n.a.createElement("ul",{className:"MainNavButton"},n.a.createElement("button",{className:this.state.for_you?"Selected":"Nav-Button",onClick:this.goToForYou},n.a.createElement("div",{className:"Nav-Text"},"For You"))),n.a.createElement("ul",{className:"MainNavButton"},n.a.createElement("button",{className:this.state.explore?"Selected":"Nav-Button",onClick:this.goToExplore},n.a.createElement("div",{className:"Nav-Text"},"Explore"))),n.a.createElement("ul",{className:"MainNavButton"},n.a.createElement("button",{className:this.state.request?"Selected":"Nav-Button",onClick:this.goToFriendRequest},n.a.createElement("div",{className:"Nav-Text"},"Requests"))),n.a.createElement("ul",{className:"MainNavButton"},n.a.createElement("button",{className:this.state.message?"Selected":"Nav-Button",onClick:this.goToMessage},n.a.createElement("div",{className:"Nav-Text"},"Messages"))),n.a.createElement("ul",{className:"MainNavButton"},n.a.createElement("button",{className:"Nav-Button",onClick:this.logOut},n.a.createElement("div",{className:"Nav-Text"},"Logout")))),n.a.createElement("div",{className:"MainContentContainer"},this.state.profile&&n.a.createElement(x,{user:this.state.user,saveBio:this.saveBio,saveCourses:this.saveCourses,saveMajors:this.saveMajors,className:"MainContent",courses:this.state.courses,majors:this.state.majors}),this.state.for_you&&n.a.createElement(q,{className:"MainContent"}),this.state.explore&&n.a.createElement(F,{className:"MainContent"}),this.state.message&&n.a.createElement(Y,{user:this.state.user,className:"MainContent"}),this.state.request&&n.a.createElement(L,{className:"MainContent"}))))}}]),a}(n.a.Component);function U(){return n.a.createElement(m.c,null,n.a.createElement(m.a,{path:"/dashboard",component:T,isPrivate:!0}),n.a.createElement(m.a,{path:"/register",component:b}),n.a.createElement(m.a,{path:"/",exact:!0,component:v}),n.a.createElement(m.a,{component:v}))}var D=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return n.a.createElement(m.b,{history:f},n.a.createElement(U,null))}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},67:function(e,t,a){e.exports=a.p+"static/media/star.54fe209c.png"},98:function(e,t,a){}},[[139,1,2]]]);
//# sourceMappingURL=main.de98529a.chunk.js.map